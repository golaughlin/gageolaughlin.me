---
import { Icon } from "astro-icon/components";
---

<button
  class="p-2 bg-gradient-to-b from-slate-200 to-slate-300 border border-slate-300 rounded-sm inset-shadow-xs inset-shadow-slate-400
                    hover:cursor-pointer hover:shadow-inner hover:shadow-slate-300 hover:bg-gradient-to-b hover:from-slate-300 hover:to-slate-400
                    dark:from-slate-800 dark:to-slate-900 dark:border-slate-950 dark:inset-shadow-slate-950
                    hover:dark:from-slate-900 hover:dark:to-slate-950 hover:dark:shadow-black"
  id="themeToggle"
  aria-label="Change Between Light and Dark Mode"
>
  <Icon
    class="text-xl text-slate-900 block dark:hidden"
    name="material-symbols:dark-mode"
  />
  <Icon
    class="text-xl text-slate-100 hidden dark:block"
    name="material-symbols:light-mode"
  />
</button>

<script is:inline>
  const theme = (() => {
    const localStorageTheme = localStorage?.getItem('theme') ?? '';
    if (['dark', 'light'].includes(localStorageTheme)) {
      return localStorageTheme;
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    } else {
      return 'light';
    }
  })();

  if (theme === 'light') {
    document.documentElement.classList.remove('dark');
  } else {
    document.documentElement.classList.add('dark');
  }

  window.localStorage.setItem('theme', theme);

  function handleToggleClick() {
    const element = document.documentElement;
    element.classList.toggle('dark');

    const isDark = element.classList.contains('dark');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  }

  document.getElementById('themeToggle')?.addEventListener('click', handleToggleClick);
</script>